repoPaths:
  ":owner/:repo": ~/src/github.com/:owner/:repo

keybindings:
  prs:
    - key: d
      command: |-
        tmux new-window -c {{.RepoPath}} '
          tmux rename-window "{{.RepoName}}#{{.PrNumber}}" &&
          WT=$(git worktree list --porcelain | grep -B2 "^branch refs/heads/{{.HeadRefName}}$" | grep "^worktree " | sed "s/^worktree //") &&
          if [ -n "$WT" ]; then
            cd "$WT"
          else
            gh pr checkout {{.PrNumber}} || { echo "Error: gh pr checkout failed"; read -r; exit 1; }
          fi &&
          BASE=$(git merge-base HEAD origin/HEAD) &&
          nvim -c ":DiffviewOpen $BASE"
        '
    - key: C
      command: |-
        tmux new-window -c {{.RepoPath}} '
          tmux rename-window "{{.RepoName}}#{{.PrNumber}}" &&
          WT=$(git worktree list --porcelain | grep -B2 "^branch refs/heads/{{.HeadRefName}}$" | grep "^worktree " | sed "s/^worktree //") &&
          if [ -n "$WT" ]; then
            cd "$WT"
          else
            gh pr checkout {{.PrNumber}} || { echo "Error: gh pr checkout failed"; read -r; exit 1; }
          fi &&
          nvim -c ":Octo pr edit {{.PrNumber}}"
        '
